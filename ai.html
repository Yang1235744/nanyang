<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>南阳数码智能AI助手</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Microsoft YaHei",sans-serif;}
body{background:url(https://picsum.photos/id/1036/1920/1080) no-repeat center center fixed;background-size:cover;position:relative;min-height:100vh;color:#fff;}
body::before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.65);z-index:-1;}
.nav{position:fixed;top:0;left:0;width:100%;padding:15px 30px;background:rgba(0,0,0,0.9);display:flex;justify-content:space-between;align-items:center;z-index:999;}
.nav .logo{font-size:22px;font-weight:bold;color:#00bcd4;}
.nav .menu a{color:#ccc;text-decoration:none;margin-left:25px;font-size:16px;}
.nav .menu a:hover{color:#00bcd4;}
.chat-container{width:100%;max-width:900px;margin:90px auto 0;padding:20px;display:flex;flex-direction:column;height:calc(100vh - 90px);}
.chat-messages{flex:1;overflow-y:auto;margin-bottom:20px;padding-right:10px;}
.chat-messages::-webkit-scrollbar{width:6px;}
.chat-messages::-webkit-scrollbar-thumb{background:#00bcd4;border-radius:3px;}
.message{margin-bottom:15px;display:flex;animation:fadeIn 0.3s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
.message.user{justify-content:flex-end;}
.message.ai{justify-content:flex-start;}
.message-content{max-width:75%;padding:12px 18px;border-radius:18px;line-height:1.6;}
.message.user .message-content{background:#007bff;border-bottom-right-radius:4px;}
.message.ai .message-content{background:#1a1a1a;border:1px solid #333;border-bottom-left-radius:4px;}
.input-container{display:flex;gap:10px;}
#user-input{flex:1;padding:14px 20px;border-radius:25px;border:none;background:rgba(255,255,255,0.1);color:#fff;font-size:16px;outline:none;backdrop-filter:blur(10px);}
#user-input::placeholder{color:#aaa;}
#send-btn{padding:14px 24px;border-radius:25px;border:none;background:#00bcd4;color:#fff;font-weight:bold;cursor:pointer;transition:all 0.2s;}
#send-btn:hover{background:#00a0b0;transform:scale(1.03);}
.typing-indicator{display:none;padding:12px 18px;background:#1a1a1a;border-radius:18px;border-bottom-left-radius:4px;max-width:70px;}
.typing-indicator span{display:inline-block;width:8px;height:8px;border-radius:50%;background:#00bcd4;margin:0 2px;animation:typing 1.4s infinite;}
.typing-indicator span:nth-child(2){animation-delay:0.2s;}
.typing-indicator span:nth-child(3){animation-delay:0.4s;}
@keyframes typing{0%,60%,100%{transform:translateY(0);opacity:0.7;}30%{transform:translateY(-10px);opacity:1;}}
</style>
</head>
<body>

<div class="nav">
  <div class="logo">南阳数码工作室</div>
  <div class="menu">
    <a href="./index.html">首页</a>
    <a href="https://www.microsoft.com" target="_blank">微软官方地址</a>
    <a href="./about.html">关于我们</a>
    <a href="./ai.html">AI 助手</a>
  </div>
</div>

<div class="chat-container">
  <div class="chat-messages" id="chat-messages">
    <div class="message ai">
      <div class="message-content">
        你好！我是南阳数码智能AI，有任何问题都可以问我！
      </div>
    </div>
  </div>
  <div class="typing-indicator" id="typing-indicator">
    <span></span><span></span><span></span>
  </div>
  <div class="input-container">
    <input type="text" id="user-input" placeholder="输入你的问题..." autocomplete="off">
    <button id="send-btn">发送</button>
  </div>
</div>

<script>
const AIEngine = {
  knowledge: {
    msDownload: {
      keywords: ["微软镜像","微软系统","win11官方","win10官方","微软官网下载"],
      reply: "你需要我为你提供微软官方的镜像下载链接吗？让我帮助您下载吗？"
    },
    system: {
      keywords: ["系统下载","镜像","win11","win10","win7","xp","纯净版"],
      reply: "首页点击「系统镜像下载」即可获取官方原版、魔改优化版系统，无捆绑无广告。"
    },
    activate: {
      keywords: ["激活","工具","密钥","c2xm","解压密码"],
      reply: "激活工具解压密码：c2xm，使用前请临时关闭杀毒软件。"
    },
    pe: {
      keywords: ["pe","启动盘","重装系统","u盘","新手pe"],
      reply: "首页可直接下载新手PE，一键制作U盘启动，适合小白安装系统。"
    },
    fix: {
      keywords: ["电脑故障","蓝屏","死机","卡顿","黑屏","重启","报错"],
      reply: "先排查软件（驱动、系统、病毒），再检查硬件（内存、硬盘、散热、电源）。"
    },
    time: {
      keywords: ["时间","几点","现在","日期","几号","星期"],
      reply: () => {
        let d = new Date();
        let y = d.getFullYear();
        let m = d.getMonth()+1;
        let day = d.getDate();
        let h = d.getHours();
        let mi = String(d.getMinutes()).padStart(2,'0');
        let week = "星期"+"日一二三四五六"[d.getDay()];
        return `现在时间：${y}年${m}月${day}日 ${h}:${mi} ${week}`;
      }
    },
    server: {
      keywords: ["服务器","搭建","linux","宝塔","网站","mc","我的世界"],
      reply: "支持Linux服务器搭建、宝塔面板、网站部署、MC服务器、无政府服搭建。"
    },
    disk: {
      keywords: ["硬盘","坏道","修复","数据恢复","ssd","hdd"],
      reply: "机械硬盘可修复坏道，固态可量产，重要文件请先备份！"
    }
  },

  think(input) {
    input = input.toLowerCase().trim();
    let best = null;
    let max = 0;

    for(let key in this.knowledge) {
      let item = this.knowledge[key];
      let score = 0;
      item.keywords.forEach(w => {
        if(input.includes(w)) score++;
      });
      if(score > max) {
        max = score;
        best = item;
      }
    }

    if(best) {
      return typeof best.reply === "function" ? best.reply() : best.reply;
    }

    return "我是南阳数码智能AI，你可以问我电脑、系统、下载、维修、服务器等任何问题！";
  }
};

const chat = document.getElementById('chat-messages');
const input = document.getElementById('user-input');
const btn = document.getElementById('send-btn');
const typing = document.getElementById('typing-indicator');

let waitForDownloadConfirm = false;

function send() {
  let text = input.value.trim();
  if(!text) return;
  addMsg(text, true);
  input.value = '';
  typing.style.display = 'block';

  setTimeout(() => {
    typing.style.display = 'none';
    let lower = text.toLowerCase();

    // 微软镜像逻辑
    if (lower.includes("微软") && (lower.includes("镜像") || lower.includes("系统")) && lower.includes("下载")) {
      waitForDownloadConfirm = true;
      addMsg("你需要我为你提供微软官方的镜像下载链接吗？让我帮助您下载吗？", false);
      return;
    }

    // 用户同意下载
    if (waitForDownloadConfirm && (lower.includes("要") || lower.includes("好") || lower.includes("可以") || lower.includes("下载") || lower.includes("行") || lower.includes("yes"))) {
      waitForDownloadConfirm = false;
      addMsg("正在为您启动微软官方镜像下载……\n链接已生效，24小时内未下载将自动收回，请尽快保存。", false);
      setTimeout(() => {
        window.open("https://www.microsoft.com/zh-cn/software-download/windows11", "_blank");
      }, 1000);
      return;
    }

    // 正常AI回答
    let ans = AIEngine.think(text);
    addMsg(ans, false);
  }, 700 + Math.random()*800);
}

function addMsg(text, isUser) {
  let div = document.createElement('div');
  div.className = `message ${isUser ? 'user' : 'ai'}`;
  let c = document.createElement('div');
  c.className = 'message-content';
  c.innerText = text;
  div.appendChild(c);
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

btn.addEventListener('click', send);
input.addEventListener('keypress', e => e.key === 'Enter' && send());
</script>
</body>
</html>
