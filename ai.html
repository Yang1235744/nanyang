function send() {
  let text = input.value.trim();
  if(!text) return;
  addMsg(text, true);
  input.value = '';
  typing.style.display = 'block';

  // 这里用你服务器的IP地址
  fetch('http://192.168.1.55:5000/api/chat', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ message: text })
  })
  .then(res => res.json())
  .then(data => {
    typing.style.display = 'none';
    addMsg(data.reply, false);
  })
  .catch(err => {
    typing.style.display = 'none';
    addMsg("服务器连接失败，请检查服务是否启动。", false);
    console.error(err);
  });
}

